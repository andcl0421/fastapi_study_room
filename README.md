# 🏫 스터디룸 예약 시스템 (Study-Room-Reservation)

> **청년취업사관학교 도봉캠퍼스 AI 서비스 개발자 과정**
> 실무 관점의 데이터 설계와 검증 로직 구현을 위한 미니 프로젝트입니다.

---

## 1.  프로젝트 구조 (Repository Structure)

* **study-room-reservation/** (최상위 루트)
    * `.gitignore` / `README.md` / `uv.lock`
    * **app/**
        * **models/** : [DB 설계도] SQLAlchemy 2.0 Mapped 기반 테이블 정의
        * **schemas/** : [데이터 규격] Pydantic 모델 (Request/Response)
        * **services/** : [핵심 로직] 비즈니스 규칙 및 검증
        * **repositories/** : [창고 관리] DB CRUD 직접 수행
        * **routers/** : [안내 데스크] API 엔드포인트
        * `database.py`: PostgreSQL 연결 및 세션 관리
        * `main.py`: 애플리케이션 진입점

---

## 2.  기획 의도 (Why)

### 2.1 개발 배경
* 학생들이 스터디룸을 예약할 때 발생하는 **중복 예약 문제**와 **무분별한 독점**을 막기 위해 체계적인 예약 시스템이 필요했습니다.

### 2.2 해결하고자 하는 문제
* **중복 예약 방지**: 동일 시간대, 동일 강의실에 대한 중복 예약을 원천 차단합니다.
* **공정한 이용**: 하루 최대 이용 시간을 제한하여 특정 사용자의 독점을 방지합니다.
* **데이터 무결성**: 과거 날짜 예약 금지, 운영 시간 외 예약 금지 등 실무적인 검증 로직을 구현합니다.

---

## 3.  설계 및 구조 (Architecture)

![ERD 설계도](./app/docs/images/erd-1.0.png)

### 3.1 Layered Architecture
* **Router → Service → Repository → Model**로 이어지는 4계층 구조를 채택했습니다.
* **이유**: API 경로(Router)와 실제 비즈니스 규칙(Service)을 분리하여 코드의 유지보수성을 높이고, 테스트가 용이한 구조를 지향했습니다.

### 3.2 DB 모델링 전략 (ERD 핵심 포인트)
* **역정규화(Denormalization) 채택**: `Review` 테이블에 `user_id`와 `room_id`를 중복 포함시켜 조회 성능을 최적화했습니다.
* **실무 표준 명명 규칙**: 모든 필드에 **Snake Case**를 적용하고, PK 필드는 `테이블명_id` 형식을 사용하여 가독성을 확보했습니다.

---

## 4.  성장 포인트 (Retrospective)

### **[Troubleshooting: 데이터 타입 불일치와 직렬화 에러]**
* **문제**: Pydantic의 `datetime` 객체가 DB의 `Date`, `Time` 필드와 호환되지 않아 `ResponseValidationError` 발생.
* **해결**: 오늘 실습 중 Service 계층에서 `.date()`와 `.time()` 메서드로 데이터를 분리 추출하여 DB에 저장하는 로직을 구현함으로써 데이터 직렬화(Serialization) 문제를 해결함.
* **배운 점**: API 스키마와 DB 모델 간의 데이터 정합성이 시스템 안정성에 미치는 중요성을 체득함.

### **[Troubleshooting: 수정(Update) 메서드 선정 및 404 에러 디버깅]**
* **문제**: 스터디룸 정보 수정 시 `PATCH` 메서드를 사용했으나, 존재하는 ID임에도 404 에러가 발생하는 현상 확인.
* **해결**: Postman의 Path Parameter 설정과 라우터의 변수 매핑을 대조하여 경로 불일치를 해결함. 자원 전체를 교체하는 `PUT` 대신 필요한 필드만 변경하는 `PATCH`의 효율성을 실전에서 검증함.

---

## 5.  업데이트 기록 (Changelog)

### **v1.6: 진정한 시스템 구축 (2026-02-20)**
* **보안 기반 다지기**: 단순 로그인을 넘어 `bcrypt` 해싱과 JWT 기반 인증 방식을 적용하여 실무 수준의 보안 인프라 구축.
* **환경 변수 자산화**: JWT 비밀 키 등을 `.env`로 관리하여 소스코드 유출 시에도 안전한 설계를 지향함.

### **v1.5: 전체 시스템 비동기 전환 (2026-02-20)**
* **Async/Await 체득**: 모든 서비스와 레포지토리 로직을 비동기로 전환하고, `run_sync` 등 비동기 환경에서의 특수 상황 처리 능력을 확보함.

### **v1.4: API 통합 및 구조화 (2026-02-20)**
* **임포트 지옥 해결**: `__init__.py`와 `__all__`을 활용하여 수많은 모델 클래스를 체계적으로 관리하는 **헤드셋 구조화** 설계 적용.

### **v1.3: 스터디룸 상세 설계 고도화 (2026-02-20)**
* **필드 확장**: ERD 기반으로 `room` 테이블에 상세 설명(`description`) 필드를 추가하고, 실제 비즈니스에 필요한 데이터 규격을 완성함.

### **v1.2: 관리자 관점의 필드 확장 (2026-02-20)**
* **운영 상태 관리**: 스터디룸에 `is_active` 필드와 `created_at` 타임스탬프를 적용하여 '데이터 추적'과 '운용 상태'를 고려한 관리자 관점의 설계를 경험함.

### **v1.1: DB 모형 및 관계 최적화 (2026-02-19)**
* **모델링 구축**: 핵심 4개 모델(User, Room, Reservation, Review) 구축 및 PostgreSQL 환경 설정 완료.
* **트레이드오프 결정**: 정규화와 조회 성능 간의 균형을 위해 리뷰 테이블의 역정규화 의사결정 수행.

### **v1.0: 프로젝트 초기화 (2026-02-19)**
* 프로젝트 아키텍처 설계 및 기본 개발 환경 세팅 완료.